
Analysis Description
--------------------
Perform a Fast Unbiased AppRoximate Bayesian (FUBAR) analysis of a
coding sequence alignment to determine whether some sites have been
subject to pervasive purifying or diversifying selection. v2.1
introduces two more methods for estimating the posterior distribution of
grid weights: collapsed Gibbs MCMC (faster) and 0-th order Variation
Bayes approximation (fastest). Please note that a FUBAR analysis
generates a cache and a results JSON file in the same directory as
directory as the original alignment. HyPhy needs to have write
privileges to this directory. For example if the original file is in
/home/sergei/FUBAR/data/pol.nex then at the end of a FUBAR run, there
will also exist FUBAR-generated files
/home/sergei/FUBAR/data/pol.nex.FUBAR.json,
/home/sergei/FUBAR/data/pol.nex.fubrar.cache. They also provide
checkpointing so that a partially completed analysis can be restarted.

- __Requirements__: in-frame codon alignment (possibly partitioned) and a phylogenetic tree
(one per partition)

- __Citation__: FUBAR: a fast, unconstrained bayesian approximation for inferring
selection (2013), Mol Biol Evol. 30(5):1196-205

- __Written by__: Sergei L Kosakovsky Pond

- __Contact Information__: spond@temple.edu

- __Analysis Version__: 2.2


>code –> Universal
/home/aglucaci/AOC-REM2/results/mammalian_REM2/mammalian_REM2_codons.SA.FilterOutliers.fasta.treefile
/home/aglucaci/AOC-REM2/results/mammalian_REM2/mammalian_REM2_codons.SA.FilterOutliers.fasta.treefile

>Loaded a multiple sequence alignment with **175** sequences, **627** codons, and **1** partitions from `/home/aglucaci/AOC-REM2/results/mammalian_REM2/mammalian_REM2_codons.SA.FilterOutliers.fasta`
Save FUBAR cache to : 
>cache –> /home/aglucaci/AOC-REM2/results/mammalian_REM2/mammalian_REM2_codons.SA.FilterOutliers.fasta.FUBAR.cache
> FUBAR will write cache and result files to _/home/aglucaci/AOC-REM2/results/mammalian_REM2/mammalian_REM2_codons.SA.FilterOutliers.fasta.FUBAR.cache_ and _/home/aglucaci/AOC-REM2/results/mammalian_REM2/mammalian_REM2_codons.SA.FilterOutliers.fasta.FUBAR.json_, respectively 


> Number of grid points per dimension (total number is D^2) (permissible range = [5,50], default value = 20, integer): 
>grid –> 20

>method –> Variational-Bayes
> The concentration parameter of the Dirichlet prior (permissible range = [0.001,1], default value = 0.5): 
>concentration_parameter –> 0.5

>non-zero –> No


### Obtaining branch lengths and nucleotide substitution biases under the nucleotide GTR model

>kill-zero-lengths –> Yes

### Deleted 15 zero-length internal branches: `Node141, Node142, Node143, Node149, Node156, Node240, Node241, Node242, Node244, Node282, Node307, Node309, Node343, Node345, Node79`
* Log(L) = -25011.81, AIC-c = 50734.38 (355 estimated parameters)
* 1 partition. Total tree length by partition (subs/site)  4.187
* Tree length (expected substitutions/site) for partition 1 :    4.187

### Computing the phylogenetic likelihood function on the grid 
* Determining appropriate tree scaling based on the best score from a  20 x 20 rate grid
* Best scaling achieved for 
	* synonymous rate =  2.815
	* non-synonymous rate =  0.429
* Computing conditional site likelihoods on a 20 x 20 rate grid

### Running an iterative zeroth order variational Bayes procedure to estimate the posterior mean of rate weights
* Using the following settings
	* Dirichlet alpha  : 0.5

### Tabulating site-level results
|     Codon      |   Partition    |     alpha      |      beta      |Posterior prob for positive selection|
|:--------------:|:--------------:|:--------------:|:--------------:|:-----------------------------------:|
|       29       |       1        |        0.957   |        2.774   |       Pos. posterior = 0.9019       |
|       30       |       1        |        0.932   |        2.814   |       Pos. posterior = 0.9154       |
|      170       |       1        |        0.146   |        0.900   |       Pos. posterior = 0.9875       |
|      219       |       1        |        3.910   |       39.208   |       Pos. posterior = 0.9442       |
|      382       |       1        |        3.423   |       35.980   |       Pos. posterior = 0.9414       |
|      443       |       1        |        3.692   |       34.776   |       Pos. posterior = 0.9297       |
|      488       |       1        |        2.738   |       34.719   |       Pos. posterior = 0.9443       |
----
## FUBAR inferred 7 sites subject to diversifying positive selection at posterior probability >= 0.9
Of these,  0.44 are expected to be false positives (95% confidence interval of 0-2 )



# Loaded config yaml file
# Loaded cluster json file
# Using nucleotide data from: data/mammalian_REM2/Rem2_refseq_transcript.fasta
# Using protein data from: data/mammalian_REM2/Rem2_refseq_protein.fasta
# Using the analysis label: mammalian_REM2
# We are operating out of base directory: /home/aglucaci/AOC-REM2
# We will create and store results in: /home/aglucaci/AOC-REM2/results/mammalian_REM2
# Directory '/home/aglucaci/AOC-REM2/results' created
# Directory '/home/aglucaci/AOC-REM2/results/mammalian_REM2' created
# Moving on to processing rules
# We have 0 clade files
[]
